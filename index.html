<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STILLFLARE // BIO-INTELLIGENCE 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --accent-blue: #0055ff;
            --deep-blue: #001a4d;
            --electric-blue: #00d4ff;
            --text-dark: #1a1f36;
            --text-light: #ffffff;
        }

        body { 
            background: #000; color: var(--text-light); 
            font-family: 'Inter', sans-serif; margin: 0; padding: 40px 20px;
            background-image: radial-gradient(circle at center, #001a4d 0%, #000 100%);
            display: flex; justify-content: center;
        }

        .maas-container { width: 100%; max-width: 950px; }

        .banner-view { text-align: center; margin-bottom: 30px; }
        .banner-view img { width: 100%; max-width: 800px; border-bottom: 2px solid var(--accent-blue); padding-bottom: 10px; }

        /* THE CALCULUS ENGINE - CENTER STAGE */
        .central-engine {
            background: rgba(0, 0, 0, 0.6); border: 2px solid var(--electric-blue);
            border-radius: 25px; padding: 40px; text-align: center; margin-bottom: 40px;
            box-shadow: 0 0 40px rgba(0, 212, 255, 0.2);
        }
        .engine-title { font-size: 11px; letter-spacing: 5px; color: var(--electric-blue); text-transform: uppercase; margin-bottom: 20px; }
        .equation { font-family: "Times New Roman", serif; font-size: 32px; font-style: italic; color: #fff; text-shadow: 0 0 10px #fff; }

        /* INFORMATION CARD - BRIGHT & READABLE */
        .info-pane {
            background: rgba(255, 255, 255, 0.95); color: var(--text-dark);
            border-radius: 30px; padding: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            display: grid; grid-template-columns: 1fr 1fr; gap: 40px;
        }

        .description h2 { color: var(--accent-blue); font-size: 20px; margin-top: 0; }
        .description p { line-height: 1.6; font-size: 14px; color: #444; }

        .glossary { font-size: 12px; margin-top: 20px; }
        .glossary b { color: var(--accent-blue); }

        /* SLIDER INTERFACE */
        .controls-area { display: flex; flex-direction: column; gap: 20px; }
        .input-block { background: #f4f7f9; padding: 15px; border-radius: 15px; border-left: 5px solid var(--accent-blue); }
        .input-label { display: flex; justify-content: space-between; font-weight: 800; font-size: 12px; margin-bottom: 10px; }
        
        input[type="range"] { 
            -webkit-appearance: none; width: 100%; height: 6px; background: #ddd; 
            border-radius: 5px; outline: none; 
        }
        input[type="range"]::-webkit-slider-thumb { 
            -webkit-appearance: none; width: 22px; height: 22px; 
            background: var(--accent-blue); border-radius: 50%; cursor: pointer;
        }

        /* DATA VIZ */
        .stats-strip { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 30px 0; }
        .stat-node { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .stat-node span { display: block; font-size: 28px; font-weight: bold; color: var(--electric-blue); }
        .stat-node label { font-size: 10px; text-transform: uppercase; color: #888; }

        .visualizer { height: 300px; background: rgba(0,0,0,0.3); border-radius: 20px; padding: 20px; border: 1px solid rgba(255,255,255,0.1); }

        .action-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        button { 
            padding: 20px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; 
            text-transform: uppercase; letter-spacing: 1px; transition: 0.3s;
        }
        .btn-commit { background: var(--accent-blue); color: white; box-shadow: 0 10px 20px rgba(0,85,255,0.3); }
        .btn-archive { background: transparent; color: white; border: 1px solid white; }
        button:hover { transform: scale(1.02); opacity: 0.9; }

    </style>
</head>
<body>

<div class="maas-container">
    <div class="banner-view">
        <img src="https://raw.githubusercontent.com/stillflareentertainment-web/stillflare-lab/main/STILLFLARE%20BANNER.png" alt="STILLFLARE">
    </div>

    <div class="central-engine">
        <div class="engine-title">Derivative Intelligence Application // Core Engine</div>
        <div class="equation">
            &Phi;(t) = \int_{0}^{t} \left[ \frac{\sum_{i=1}^{4} V_{i}}{4} \right] dt
        </div>
        <p style="font-size: 11px; color: var(--electric-blue); margin-top: 15px;">CALCULATING NEURAL TRAJECTORY...</p>
    </div>

    <div class="info-pane">
        <div class="description">
            <h2>MAAS Protocol Overview</h2>
            <p>The <b>Biological Intelligence Suite</b> uses calculus-based integration to map your operational capacity. By adjusting the vectors below, you define your local neural identity.</p>
            
            <div class="glossary">
                <p><b>QS:</b> Quality of Service - Your output efficiency.</p>
                <p><b>OI:</b> Operational Intel - Awareness and strategic clarity.</p>
                <p><b>IC:</b> Internal Capacity - Neural and physical energy reserves.</p>
                <p><b>EP:</b> Engine Power - The raw force of your application.</p>
            </div>
        </div>

        <div class="controls-area">
            <div class="input-block">
                <div class="input-label"><span>QS_SERVICE</span><span id="qsVal">50%</span></div>
                <input type="range" id="qs" min="0" max="100" value="50" oninput="u('qs')">
            </div>
            <div class="input-block">
                <div class="input-label"><span>OI_INTEL</span><span id="oiVal">50%</span></div>
                <input type="range" id="oi" min="0" max="100" value="50" oninput="u('oi')">
            </div>
            <div class="input-block">
                <div class="input-label"><span>IC_CAPACITY</span><span id="icVal">50%</span></div>
                <input type="range" id="ic" min="0" max="100" value="50" oninput="u('ic')">
            </div>
            <div class="input-block">
                <div class="input-label"><span>EP_ENGINE</span><span id="epVal">50%</span></div>
                <input type="range" id="ep" min="0" max="100" value="50" oninput="u('ep')">
            </div>
        </div>
    </div>

    <div class="stats-strip">
        <div class="stat-node"><span id="globalPulse">--%</span><label>Global Mean</label></div>
        <div class="stat-node"><span id="personalPulse">--%</span><label>Identity Mean</label></div>
        <div class="stat-node"><span id="trendVal">--</span><label>Stability Vector</label></div>
    </div>

    <div class="visualizer"><canvas id="mainChart"></canvas></div>

    <div class="action-btns">
        <button class="btn-commit" onclick="transmitData()">Commit Telemetry</button>
        <button class="btn-archive" onclick="generateReport()">Archive Report</button>
    </div>
</div>

<script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRRO9rzX0DOaCBEppRFcRXtsIxxgK6fT6KIxAjFhq44PaoBEAtEy8fwjTEFNc9QZofF2P9srq0eYT4c/pub?gid=718698897&single=true&output=csv";
    let mainChart;

    function u(id) { document.getElementById(id + 'Val').innerText = document.getElementById(id).value + '%'; }

    function initChart() {
        const ctx = document.getElementById('mainChart').getContext('2d');
        mainChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [], 
                datasets: [
                    { label: 'GLOBAL', borderColor: 'rgba(255,255,255,0.1)', data: [], tension: 0.4, borderWidth: 1, pointRadius: 0 },
                    { label: 'IDENTITY', borderColor: '#0055ff', backgroundColor: 'rgba(0,85,255,0.2)', data: [], tension: 0.4, fill: true, borderWidth: 3, pointRadius: 4 }
                ]
            },
            options: { 
                responsive: true, maintainAspectRatio: false, 
                plugins: { legend: { labels: { color: '#fff' } } },
                scales: { 
                    y: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#444' } },
                    x: { ticks: { color: '#444' } }
                }
            }
        });
    }

    async function syncData() {
        try {
            const res = await fetch(CSV_URL + "&cb=" + Date.now());
            const data = await res.text();
            const rows = data.split('\n').filter(r => r.trim() !== "").slice(1);
            let commData = []; let total = 0;
            rows.forEach(r => {
                const c = r.split(',');
                if(c.length >= 5) {
                    const avg = (parseInt(c[1]) + parseInt(c[2]) + parseInt(c[3]) + parseInt(c[4])) / 4;
                    commData.push(avg); total += avg;
                }
            });
            document.getElementById('globalPulse').innerText = (rows.length > 0 ? Math.round(total / rows.length) : 0) + "%";
            const pData = JSON.parse(localStorage.getItem('stillflare_history') || "[]");
            if (pData.length > 0) {
                document.getElementById('personalPulse').innerText = pData[pData.length - 1] + "%";
                const diff = (pData.length >= 2) ? pData[pData.length - 1] - pData[pData.length - 2] : 0;
                document.getElementById('trendVal').innerText = diff >= 0 ? "OPTIMIZED" : "STRESSED";
            }
            mainChart.data.labels = Array.from({length: Math.max(rows.length, pData.length)}, (_, i) => i + 1);
            mainChart.data.datasets[0].data = commData;
            mainChart.data.datasets[1].data = pData;
            mainChart.update();
        } catch (e) { console.error(e); }
    }

    async function transmitData() {
        const v = [document.getElementById('qs').value, document.getElementById('oi').value, document.getElementById('ic').value, document.getElementById('ep').value];
        const avg = Math.round(v.reduce((a,b) => parseInt(a)+parseInt(b)) / 4);
        let h = JSON.parse(localStorage.getItem('stillflare_history') || "[]");
        h.push(avg); localStorage.setItem('stillflare_history', JSON.stringify(h));
        const fID = "1FAIpQLSeqartuUmgNYc5RWaREX2yX0aGJU8_hWgAw8GKZiLK2QoXFpQ";
        const url = `https://docs.google.com/forms/d/e/${fID}/formResponse?entry.931849910=${v[0]}&entry.1206314523=${v[1]}&entry.1670010429=${v[2]}&entry.152757542=${v[3]}&submit=Submit`;
        fetch(url, { mode: 'no-cors' }).then(() => syncData());
    }

    function generateReport() {
        const g = document.getElementById('globalPulse').innerText;
        const l = document.getElementById('personalPulse').innerText;
        const t = document.getElementById('trendVal').innerText;
        const h = JSON.parse(localStorage.getItem('stillflare_history') || "[]");
        
        const rw = window.open('', '_blank');
        rw.document.write(`
            <html>
            <head><title>HR_BIO_ARCHIVE</title><style>
                body { font-family: "Courier New", monospace; padding: 40px; }
                .border { border: 2px solid #000; padding: 30px; }
                h1 { border-bottom: 2px solid #000; padding-bottom: 10px; }
                table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                td { border: 1px solid #000; padding: 8px; text-align: center; }
            </style></head>
            <body>
                <div class="border">
                    <h1>STILLFLARE LABS // HR TELEMETRY ARCHIVE</h1>
                    <p>SYSTEM PROTOCOL: MAAS BIOLOGY 2026</p>
                    <p>ENGINE_LOG: &Phi;(t) Integration Logic Verified</p>
                    <hr>
                    <p>GLOBAL_MEAN: ${g}</p>
                    <p>LOCAL_MEAN: ${l}</p>
                    <p>STABILITY: ${t}</p>
                    <table>
                        <tr><td>ENTRY</td><td>VECTOR_SUM</td></tr>
                        ${h.map((v, i) => `<tr><td>#${i+1}</td><td>${v}%</td></tr>`).join('')}
                    </table>
                    <br><button onclick="window.print()">[ PRINT_ARCHIVE ]</button>
                </div>
            </body>
            </html>
        `);
        rw.document.close();
    }

    window.onload = () => { initChart(); syncData(); };
</script>
</body>
</html>
